node {

    String BRANCH_PLATFORM = ""

    stage ('Checkout') {
        // Checkout code for the pushed branch
        checkout scm

        // Get the name of the Platform that was committed to (i.e. master, server, ios, android, etc.)
        BRANCH_PLATFORM = sh(script: '''#!/bin/bash
            gitHead=$(git describe --contains --all HEAD)
            newVar=${gitHead#*/}
            newerVar=${newVar#*/}
            finalVar=${newerVar%%/*}
            echo $finalVar
        ''', returnStdout: true).trim()

        println BRANCH_PLATFORM
    }

    stage ('Build') {

        def nodeHome = tool 'NodeTool'
        env.PATH="${env.PATH}:${nodeHome}/bin"

        sh '''#!/bin/bash
            cd src/web
            npm install
            bower install
            grunt
        '''
    }

    stage ('Deploy') {
        println "deploy to aws s3"
    }
}